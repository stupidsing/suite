use external STANDARD ~
define combinations :=
	case
	|| `$h; $t` => t | combinations | invoke/ | map/ {id; (h | cons | map);} | concat
	|| anything => ();
~
define permutations :=
	let shuffles :=
		define interleaves := e =>
			case
			|| `$h; $t` => t | interleaves {e} | map {cons {h}} | cons {e; h; t}
			|| anything => (e;);
		~
		case
		|| `$h; $t` => t | shuffles | map {interleaves {h}} | concat
		|| anything => ();
	~
	concat . map {shuffles} . combinations
~
